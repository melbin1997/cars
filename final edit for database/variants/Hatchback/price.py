from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import pickle
from bs4 import BeautifulSoup
import urllib
import re

links = ['https://www.cardekho.com/overview/Maserati_Gran_Turismo/Maserati_Gran_Turismo_4.2_V8.htm', 'https://www.cardekho.com/overview/Mercedes-Benz_S-Class/Mercedes-Benz_S-Class_Maybach_S500.htm', 'https://www.cardekho.com/overview/Jaguar_F_Type/Jaguar_F_Type_S_Coupe.htm', 'https://www.cardekho.com/overview/Mercedes-Benz_AMG_GT/Mercedes-Benz_AMG_GT_S.htm', 'https://www.cardekho.com/overview/Porsche_Cayman/Porsche_Cayman_GT4.htm', 'https://www.cardekho.com/overview/BMW_M_Series/BMW_M_Series_M6_Gran_Coupe.htm', 'https://www.cardekho.com/overview/BMW_M_Series/BMW_M_Series_X6_M.htm', 'https://www.cardekho.com/overview/Rolls-Royce_Wraith/Rolls-Royce_Wraith_Coupe.htm', 'https://www.cardekho.com/overview/Ferrari_488_GTB/Ferrari_488_GTB_V8.htm', 'https://www.cardekho.com/overview/Rolls-Royce_Phantom/Rolls-Royce_Phantom_Phantom.htm', 'https://www.cardekho.com/overview/Rolls-Royce_Phantom/Rolls-Royce_Phantom_Extended_Wheelbase.htm', 'https://www.cardekho.com/overview/Bentley_Continental/Bentley_Continental_GT_V8_S_Convertible.htm', 'https://www.cardekho.com/overview/Jaguar_F_Type/Jaguar_F_Type_Coupe.htm', 'https://www.cardekho.com/overview/BMW_M_Series/BMW_M_Series_M5_Sedan.htm', 'https://www.cardekho.com/overview/Land_Rover_Range_Rover_Evoque/Land_Rover_Range_Rover_Evoque_Pure.htm', 'https://www.cardekho.com/overview/Porsche_911/Porsche_911_Carrera_S.htm', 'https://www.cardekho.com/overview/Aston_Martin_Vantage/Aston_Martin_Vantage_V8_Sport.htm', 'https://www.cardekho.com/overview/Bentley_Continental/Bentley_Continental_GT_V8.htm', 'https://www.cardekho.com/overview/Aston_Martin_Vantage/Aston_Martin_Vantage_V8_4.7L.htm', 'https://www.cardekho.com/overview/Mercedes-Benz_S-Class/Mercedes-Benz_S-Class_S_63_AMG.htm', 'https://www.cardekho.com/overview/Jaguar_F_Type/Jaguar_F_Type_3.0_V6_S.htm', 'https://www.cardekho.com/overview/Porsche_911/Porsche_911_Turbo.htm', 'https://www.cardekho.com/overview/Land_Rover_Range_Rover_Evoque/Land_Rover_Range_Rover_Evoque_Coupe_HSE_Dynamic.htm', 'https://www.cardekho.com/overview/Aston_Martin_Vantage/Aston_Martin_Vantage_V12_6.0L.htm', 'https://www.cardekho.com/overview/Audi_TT/Audi_TT_45_TFSI.htm', 'https://www.cardekho.com/overview/Mercedes-Benz_GLE_Class/Mercedes-Benz_GLE_Class_250d.htm', 'https://www.cardekho.com/overview/Aston_Martin_Vantage/Aston_Martin_Vantage_V8_Roadster.htm', 'https://www.cardekho.com/overview/Bentley_Continental/Bentley_Continental_GT.htm', 'https://www.cardekho.com/overview/Mercedes-Benz_S-Class/Mercedes-Benz_S-Class_Maybach_S600.htm', 'https://www.cardekho.com/overview/Mercedes-Benz_GLE_Class/Mercedes-Benz_GLE_Class_350d.htm', 'https://www.cardekho.com/overview/Ferrari_FF/Ferrari_FF_GT.htm', 'https://www.cardekho.com/overview/Mercedes-Benz_S-Class/Mercedes-Benz_S-Class_S_350_CDI.htm', 'https://www.cardekho.com/overview/Lamborghini_Huracan/Lamborghini_Huracan_LP_610_4_Spyder.htm', 'https://www.cardekho.com/overview/Ferrari_F12berlinetta/Ferrari_F12berlinetta_V12.htm', 'https://www.cardekho.com/overview/Mercedes-Benz_GLE_Class/Mercedes-Benz_GLE_Class_Coupe.htm', 'https://www.cardekho.com/overview/Lamborghini_Huracan/Lamborghini_Huracan_LP_580_2.htm', 'https://www.cardekho.com/overview/Mercedes-Benz_S-Class/Mercedes-Benz_S-Class_S_63_AMG_Coupe.htm', 'https://www.cardekho.com/overview/Land_Rover_Range_Rover_Evoque/Land_Rover_Range_Rover_Evoque_HSE_Dynamic.htm', 'https://www.cardekho.com/overview/Porsche_911/Porsche_911_Turbo_S_Cabriolet.htm', 'https://www.cardekho.com/overview/Ferrari_458_Speciale/Ferrari_458_Speciale_V8.htm', 'https://www.cardekho.com/overview/Mercedes-Benz_GLE_Class/Mercedes-Benz_GLE_Class_400_4MATIC.htm', 'https://www.cardekho.com/overview/Rolls-Royce_Phantom/Rolls-Royce_Phantom_Coupe.htm', 'https://www.cardekho.com/overview/Jaguar_F_Type/Jaguar_F_Type_R_Coupe.htm', 'https://www.cardekho.com/overview/Land_Rover_Range_Rover_Evoque/Land_Rover_Range_Rover_Evoque_HSE.htm', 'https://www.cardekho.com/overview/Lamborghini_Huracan/Lamborghini_Huracan_AVIO.htm', 'https://www.cardekho.com/overview/Mercedes-Benz_S-Class/Mercedes-Benz_S-Class_S_500_Coupe.htm', 'https://www.cardekho.com/overview/Jaguar_F_Type/Jaguar_F_Type_5.0_V8_S.htm', 'https://www.cardekho.com/overview/DC_Avanti/DC_Avanti_2.0_L.htm', 'https://www.cardekho.com/overview/Bentley_Continental/Bentley_Continental_GT_V8_Convertible.htm', 'https://www.cardekho.com/overview/Mercedes-Benz_S-Class/Mercedes-Benz_S-Class_S_Guard.htm', 'https://www.cardekho.com/overview/BMW_M_Series/BMW_M_Series_M3_Sedan.htm', 'https://www.cardekho.com/overview/Aston_Martin_DB11/Aston_Martin_DB11_V12.htm', 'https://www.cardekho.com/overview/Porsche_Cayman/Porsche_Cayman_GTS.htm', 'https://www.cardekho.com/overview/Lamborghini_Aventador/Lamborghini_Aventador_Roadster_LP_700_4.htm', 'https://www.cardekho.com/overview/Porsche_911/Porsche_911_Carrera_Cabriolet.htm', 'https://www.cardekho.com/overview/Porsche_911/Porsche_911_Carrera.htm', 'https://www.cardekho.com/overview/Bentley_Continental/Bentley_Continental_GT_Speed_Convertible.htm', 'https://www.cardekho.com/overview/Porsche_911/Porsche_911_Turbo_Cabriolet.htm', 'https://www.cardekho.com/overview/Bentley_Continental/Bentley_Continental_GTC.htm', 'https://www.cardekho.com/overview/Rolls-Royce_Phantom/Rolls-Royce_Phantom_Drophead_Coupe.htm', 'https://www.cardekho.com/overview/Porsche_911/Porsche_911_Turbo_S.htm', 'https://www.cardekho.com/overview/Porsche_Cayman/Porsche_Cayman_S_Tiptronic.htm', 'https://www.cardekho.com/overview/Land_Rover_Range_Rover_Evoque/Land_Rover_Range_Rover_Evoque_SE.htm', 'https://www.cardekho.com/overview/Lamborghini_Huracan/Lamborghini_Huracan_LP_610_4.htm', 'https://www.cardekho.com/overview/BMW_M_Series/BMW_M_Series_M4_Coupe.htm', 'https://www.cardekho.com/overview/BMW_M_Series/BMW_M_Series_X5_M.htm', 'https://www.cardekho.com/overview/Mercedes-Benz_S-Class/Mercedes-Benz_S-Class_S400.htm', 'https://www.cardekho.com/overview/Lamborghini_Aventador/Lamborghini_Aventador_LP700_4.htm', 'https://www.cardekho.com/overview/Bentley_Continental/Bentley_Continental_GT_Speed.htm', 'https://www.cardekho.com/overview/Bentley_Continental/Bentley_Continental_GT_V8_S.htm', 'https://www.cardekho.com/overview/Aston_Martin_Vanquish/Aston_Martin_Vanquish_V12.htm', 'https://www.cardekho.com/overview/Audi_R8/Audi_R8_V10_Plus.htm', 'https://www.cardekho.com/overview/Porsche_911/Porsche_911_Carrera_S_Cabriolet.htm', 'https://www.cardekho.com/overview/Mercedes-Benz_S-Class/Mercedes-Benz_S-Class_Maybach_S600_Guard.htm']
prices = {}
failed = []

for url in links:
	try:
		page = urllib.urlopen(url)
		soup = BeautifulSoup(page.read())
		soup=soup.find("div", {"class": "priceleft"})
		soup = ''.join(soup.findAll('span')[0].findAll(text=True)[2:4])
		print url,'-->',soup
		prices[url] = soup
	except Exception as e:
		print url
		failed.append(url)

pickle.dump(prices, open("price_coupe.p", "wb"))
pickle.dump(failed, open("failed.p", "wb"))
